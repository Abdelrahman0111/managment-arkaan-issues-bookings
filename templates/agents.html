{% extends "base.html" %}

{% block content %}
<div class="content-card">
    <h2>ğŸ‘¥ Ø¥Ø¶Ø§ÙØ© ÙˆÙƒÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h2>
    <form id="agentForm" class="mt-4">
        <div class="mb-3">
            <label class="form-label">ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„</label>
            <input type="text" class="form-control" id="agent_name" required>
        </div>
        <button type="submit" class="btn btn-primary btn-lg w-100">âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆÙƒÙŠÙ„</button>
    </form>
</div>

<div class="content-card">
    <h3>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ ({{ agents|length }} ÙˆÙƒÙŠÙ„)</h3>
    <table class="table table-striped mt-3">
        <thead>
            <tr>
                <th>Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„</th>
                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©</th>
            </tr>
        </thead>
        <tbody>
            {% for agent in agents %}
            <tr>
                <td>{{ agent.agent_name }}</td>
                <td>{{ agent.created_at }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('agentForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const agent_name = document.getElementById('agent_name').value;
    
    const response = await fetch('/add_agent', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({agent_name})
    });
    
    if (response.ok) {
        alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆÙƒÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!');
        location.reload();
    }
});
</script>
{% endblock %}
